(function(){var t,r,i,n,e,o;for(n="Boolean Number String Function Array Date RegExp Object".split(" "),r=[],e=0,o=n.length;o>e;e++)i=n[e],r["[object "+i+"]"]=i.toLowerCase();t=function(){function t(){this.definitions={},this.traits={}}return t.prototype.sequence=function(t){var r;return r=0,null==t&&(t=function(t){return""+t}),function(){return t(++r)}},t.prototype.trait=function(t,r){return this.traits[t]=r},t.prototype.typeOf=function(t){return null===t||void 0===t?t+"":r[Object.prototype.toString.call(t)]||"object"},t.prototype.define=function(t,r,i){var n,e,o,s,a;if(this.definitions.hasOwnProperty(t))throw Error("there is an existing factory definition for "+t);if(2===arguments.length?(i=r,r={}):3===arguments.length?r||(r={}):1===arguments.length&&(r={},i={}),i||(i={}),i.id||(i.id=this.sequence()),n=r.from,n&&this.definitions.hasOwnProperty(n))i=$.extend({},this.definitions[n],i);else if(n&&!this.definitions.hasOwnProperty(n))throw Error("Undefined factory: "+n);for(r.traits||(r.traits=[]),"string"==typeof r.traits&&(r.traits=[r.traits]),a=r.traits,o=0,s=a.length;s>o;o++){if(e=a[o],!this.traits.hasOwnProperty(e))throw Error("there is no trait definition for "+e);i=$.extend(!0,{},this.traits[e],i)}return this.definitions[t]=i},t.prototype.build=function(t,r){var i,n;if(null==r&&(r={}),!this.definitions.hasOwnProperty(t))throw Error("there is no factory definition for "+t);return i=this.definitions[t],n=$.extend(!0,{},i,r),this._evaluateFunctions(n)},t.prototype._evaluateFunctions=function(t){var r,i,n;for(r in t)switch(n=t[r],this.typeOf(n)){case"function":i=t[r](),delete t[r],t[r]=i;break;case"object":t[r]=this._evaluateFunctions(n);break;default:}return t},t.prototype.create=function(t,r){var i;if(null==r&&(r={}),!this.adapter)throw Error("Cannot create without an adapter!");return i=this.build(t,r),this.adapter.save(t,i)},t.prototype.tearDown=function(){var t,r,i,n,e;i=this.definitions;for(t in i)r=i[t],delete this.definitions[t];n=this.traits,e=[];for(t in n)r=n[t],e.push(delete this.traits[t]);return e},t}(),exports.Foundry=t}).call(this),function(){var t;t=function(){function t(){}return t.prototype.save=function(t,r){return r},t}(),exports.Foundry||(exports.Foundry={}),exports.Foundry.NullAdapter=t}.call(this);